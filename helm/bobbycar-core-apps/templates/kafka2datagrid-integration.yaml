apiVersion: camel.apache.org/v1
kind: Integration
metadata:
  name: kafka2datagrid
  labels:
    app.kubernetes.io/part-of: {{ .Values.appName }}
spec:
  configuration:
    - type: secret
      value: kafka2datagrid
  profile: OpenShift
  dependencies:
    - camel:netty-http
  sources:
    - content: {{ .Files.Get "data/java/KafkaToDatagridRoute.java" | quote }}
      name: KafkaToDatagridRoute.java
  template:
    spec:
      containers:
        - name: integration
          env:
            - name: DROGUE_USER
              valueFrom:
                secretKeyRef:
                  name: drogue-iot-commands
                  key: user
            - name: DROGUE_ACCESS_TOKEN
              valueFrom:
                secretKeyRef:
                  name: drogue-iot-commands
                  key: token
  traits:
    service:
      configuration:
        enabled: false